<!DOCTYPE html>
<html lang="en" dir="auto">

<head><meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="robots" content="index, follow">
<title>Golang | @h12</title>
<meta name="keywords" content="">
<meta name="description" content="">
<meta name="author" content="Hǎi-Liàng &#34;Hal&#34; Wáng">
<link rel="canonical" href="http://h12.io/tags/golang/">
<link crossorigin="anonymous" href="/assets/css/stylesheet.e79680cc8f2e2a0d9f078e6e22c427fd586eec7270ad113adecb066443cb0b97.css" integrity="sha256-55aAzI8uKg2fB45uIsQn/Vhu7HJwrRE63ssGZEPLC5c=" rel="preload stylesheet" as="style">
<link rel="icon" href="http://h12.io/favicon.ico">
<link rel="icon" type="image/png" sizes="16x16" href="http://h12.io/favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="http://h12.io/favicon-32x32.png">
<link rel="apple-touch-icon" href="http://h12.io/apple-touch-icon.png">
<link rel="mask-icon" href="http://h12.io/safari-pinned-tab.svg">
<meta name="theme-color" content="#2e2e33">
<meta name="msapplication-TileColor" content="#2e2e33">
<link rel="alternate" type="application/rss+xml" href="http://h12.io/tags/golang/index.xml">
<link rel="alternate" hreflang="en" href="http://h12.io/tags/golang/">
<noscript>
    <style>
        #theme-toggle,
        .top-link {
            display: none;
        }

    </style>
    <style>
        @media (prefers-color-scheme: dark) {
            :root {
                --theme: rgb(29, 30, 32);
                --entry: rgb(46, 46, 51);
                --primary: rgb(218, 218, 219);
                --secondary: rgb(155, 156, 157);
                --tertiary: rgb(65, 66, 68);
                --content: rgb(196, 196, 197);
                --code-block-bg: rgb(46, 46, 51);
                --code-bg: rgb(55, 56, 62);
                --border: rgb(51, 51, 51);
            }

            .list {
                background: var(--theme);
            }

            .list:not(.dark)::-webkit-scrollbar-track {
                background: 0 0;
            }

            .list:not(.dark)::-webkit-scrollbar-thumb {
                border-color: var(--theme);
            }
        }

    </style>
</noscript>
<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=PT+Sans+Narrow&family=PT+Serif:ital,wght@0,400;0,700;1,400;1,700&display=swap" rel="stylesheet">


<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.7.2/css/fontawesome.min.css" crossorigin="anonymous" referrerpolicy="no-referrer" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.7.2/css/regular.min.css" crossorigin="anonymous" referrerpolicy="no-referrer" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.7.2/css/brands.min.css" crossorigin="anonymous" referrerpolicy="no-referrer" />












<meta property="og:url" content="http://h12.io/tags/golang/">
  <meta property="og:site_name" content="@h12">
  <meta property="og:title" content="Golang">
  <meta property="og:locale" content="en-us">
  <meta property="og:type" content="website">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Golang">
<meta name="twitter:description" content="">

</head>

<body class="list" id="top">
<script>
    if (localStorage.getItem("pref-theme") === "dark") {
        document.body.classList.add('dark');
    } else if (localStorage.getItem("pref-theme") === "light") {
        document.body.classList.remove('dark')
    } else if (window.matchMedia('(prefers-color-scheme: dark)').matches) {
        document.body.classList.add('dark');
    }

</script>

<header class="header">
    <nav class="nav">
        <div class="logo">
            <a href="http://h12.io/" accesskey="h" title="@h12 (Alt + H)">@h12</a>
            <div class="logo-switches">
                <button id="theme-toggle" accesskey="t" title="(Alt + T)" aria-label="Toggle theme">
                    <svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path>
                    </svg>
                    <svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <circle cx="12" cy="12" r="5"></circle>
                        <line x1="12" y1="1" x2="12" y2="3"></line>
                        <line x1="12" y1="21" x2="12" y2="23"></line>
                        <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
                        <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
                        <line x1="1" y1="12" x2="3" y2="12"></line>
                        <line x1="21" y1="12" x2="23" y2="12"></line>
                        <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
                        <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
                    </svg>
                </button>
            </div>
        </div>
        <ul id="menu">
            <li>
                <a href="http://h12.io/article/" title="Articles">
                    <span><i class="fas fa-newspaper"></i> Articles</span>
                </a>
            </li>
            <li>
                <a href="http://h12.io/project/" title="Projects">
                    <span><i class="fab fa-github"></i> Projects</span>
                </a>
            </li>
            <li>
                <a href="http://h12.io/note/" title="Notes">
                    <span><i class="fas fa-sticky-note"></i> Notes</span>
                </a>
            </li>
            <li>
                <a href="http://h12.io/about/" title="About">
                    <span><i class="fas fa-user"></i> About</span>
                </a>
            </li>
        </ul>
    </nav>
</header>
<main class="main"> 
<header class="page-header">
 



  <h1>
    Golang
  </h1>
</header>

<article class="post-entry tag-entry"> 
  <header class="entry-header">
    <h2 class="entry-hint-parent">Run: Graceful Goroutine Orchestration
    </h2>
  </header>
  <div class="entry-content">
    <p>
Overview While Go provides goroutines, channels and selects as first-class citizens to support concurrent programming, it is not trivial to combine these elements to address important concerns of goroutine orchestration, e.g. error handling, panic recovery, goroutine leak prevention, goroutine reuse, goroutine throttle and logging.
The package provides a mini-framework to address those cross-cutting concerns.
Quick start go get -u h12.io/run Here is an example illustrating the usage of the goroutine pool and the group. The task is described in the “Google Search 2.0” page from this slide.
...</p>
  </div>
  <footer class="entry-footer"><span title='2018-12-14 00:00:00 +0000 UTC'>December 14, 2018</span></footer>
  <a class="entry-link" aria-label="post link to Run: Graceful Goroutine Orchestration" href="http://h12.io/project/run/"></a>
</article>

<article class="post-entry tag-entry"> 
  <header class="entry-header">
    <h2 class="entry-hint-parent">Pagination Done Right
    </h2>
  </header>
  <div class="entry-content">
    <p>Server side pagination is intrinsically not accurate, as long as the data is dynamic.
The data items could be inserted, deleted or changed on the server side while the user goes forward and backward among the pages.
However, there is an algorithm that can keep the pagination as stable as possible:
encode the id and sorting fields of last value in a page as the continue-token return the continue-token along with each page the client must pass the continue-token to fetch the next page the next page starts with value &gt; continue-token || (value == continue-token &amp;&amp; value.id &gt; continue-token.id) Reference Pagination with Dynamic Data Loading </p>
  </div>
  <footer class="entry-footer"><span title='2018-02-28 13:38:45 +0800 +0800'>February 28, 2018</span></footer>
  <a class="entry-link" aria-label="post link to Pagination Done Right" href="http://h12.io/note/pagination-done-right/"></a>
</article>

<article class="post-entry tag-entry"> 
  <header class="entry-header">
    <h2 class="entry-hint-parent">buid: Bipartite Unique Identifier
    </h2>
  </header>
  <div class="entry-content">
    <p>A BUID is a 128-bit unique ID composed of two 64-bit parts: shard and key.
It is not only a unique ID, but also contains the sharding information, so that the messages with the same BUID could be stored together within the same DB shard.
Also, when a message is stored in a shard, the shard part of the BUID can be trimmed off to save the space, and only the key part needs to be stored as the primary key.
...</p>
  </div>
  <footer class="entry-footer"><span title='2017-11-15 20:00:00 +0800 +0800'>November 15, 2017</span></footer>
  <a class="entry-link" aria-label="post link to buid: Bipartite Unique Identifier" href="http://h12.io/project/buid/"></a>
</article>

<article class="post-entry tag-entry"> 
  <header class="entry-header">
    <h2 class="entry-hint-parent">ua: User-Agent parser in Go
    </h2>
  </header>
  <div class="entry-content">
    <p>Design The UA detection algorithm is a pipeline containing 3 steps:
Scan: scan products and its corresponding comments from a UA string. Parse: parse device info from products. Detect: detect device model by looking up in a database and get related info, e.g. screen resolution. Scan The scanner scans the user agent string into products. Each product has its own name, version and comments. e.g.
For user agent string:
Mozilla/5.0 (Linux; U; Android ROM v3; en-us; ALCATEL ONE TOUCH 991 Build/GRK39F) AppleWebKit/533.1 (KHTML, like Gecko) Version/4.0 Mobile Safari/533.1 Its products are:
...</p>
  </div>
  <footer class="entry-footer"><span title='2016-07-18 06:00:00 +0800 +0800'>July 18, 2016</span></footer>
  <a class="entry-link" aria-label="post link to ua: User-Agent parser in Go" href="http://h12.io/project/ua/"></a>
</article>

<article class="post-entry tag-entry"> 
  <header class="entry-header">
    <h2 class="entry-hint-parent">Sending Email from Gmail using Go
    </h2>
  </header>
  <div class="entry-content">
    <p> Turn on “2-Step Verification” so that an “App password” can be generated
go get gopkg.in/gomail.v2
Send your Email like the example below:
package main import ( &#34;gopkg.in/gomail.v2&#34; ) func main() { m := gomail.NewMessage() m.SetHeader(&#34;From&#34;, &#34;from_address@gmail.com&#34;) m.SetAddressHeader(&#34;To&#34;, &#34;to_adress@xxx&#34;, &#34;to_name&#34;) m.SetAddressHeader(&#34;Cc&#34;, &#34;cc_adress@xxx&#34;, &#34;cc_name&#34;) m.SetHeader(&#34;Subject&#34;, &#34;Hello! TEST!&#34;) m.SetBody(&#34;text/html&#34;, &#34;Hello! &lt;b&gt;TEST&lt;/b&gt;!&#34;) d := gomail.NewPlainDialer(&#34;smtp.gmail.com&#34;, 587, &#34;from_address@gmail.com&#34;, &#34;the App password&#34;) if err := d.DialAndSend(m); err != nil { panic(err) } } </p>
  </div>
  <footer class="entry-footer"><span title='2016-01-31 20:31:06 +0800 +0800'>January 31, 2016</span></footer>
  <a class="entry-link" aria-label="post link to Sending Email from Gmail using Go" href="http://h12.io/note/send-email-from-gmail/"></a>
</article>

<article class="post-entry tag-entry"> 
  <header class="entry-header">
    <h2 class="entry-hint-parent">SEJ: Message Queue Based on Segmented Journals
    </h2>
  </header>
  <div class="entry-content">
    <p>h12.io/sej provides composable components of distributed, persisted message queue and allows trading off between reliablilty, latency and throughput with minimal devops overhead.
Package Organization h12.io/sej: writer, scanner and offset shard: sharding hub: copying across machines cmd/sej: command line tool SEJ Directory [root-dir]/ [sej-dir]/ jnl.lck jnl/ 0000000000000000.jnl 000000001f9e521e.jnl ...... ofs/ reader1.ofs reader1.lck reader2.ofs reader2.lck ...... Journal File format segment_file = { message } . message = offset timestamp type key value size . offset = uint64 . timestamp = int64 . type = uint8 . key = key_size { uint8 } . key_size = int8 . value = value_size { uint8 } . value_size = int32 . size = int32 . All integers are written in the big endian format.
...</p>
  </div>
  <footer class="entry-footer"><span title='2015-11-14 15:00:00 +0800 +0800'>November 14, 2015</span></footer>
  <a class="entry-link" aria-label="post link to SEJ: Message Queue Based on Segmented Journals" href="http://h12.io/project/sej/"></a>
</article>

<article class="post-entry tag-entry"> 
  <header class="entry-header">
    <h2 class="entry-hint-parent">RealTest: real test environment for Go
    </h2>
  </header>
  <div class="entry-content">
    <p>h12.io/realtest provides real test environment for Go unit testing, based on Docker.
Includes:
Queue Kafka cluster (with zookeeper) Database: MySQL MongoDB Cache Redis Configuration service ZooKeeper </p>
  </div>
  <footer class="entry-footer"><span title='2015-11-14 13:57:09 +0800 +0800'>November 14, 2015</span></footer>
  <a class="entry-link" aria-label="post link to RealTest: real test environment for Go" href="http://h12.io/project/realtest/"></a>
</article>

<article class="post-entry tag-entry"> 
  <header class="entry-header">
    <h2 class="entry-hint-parent">JSON Schema parser &amp; code generator
    </h2>
  </header>
  <div class="entry-content">
    <p>json-schema generates Go struct from a JSON Schema specification.
Decimal types are supported for accurate currency calculation.
</p>
  </div>
  <footer class="entry-footer"><span title='2015-11-04 19:00:00 +0800 +0800'>November 4, 2015</span></footer>
  <a class="entry-link" aria-label="post link to JSON Schema parser & code generator" href="http://h12.io/project/json-schema/"></a>
</article>

<article class="post-entry tag-entry"> 
  <header class="entry-header">
    <h2 class="entry-hint-parent">Aliyun OSS Go SDK
    </h2>
  </header>
  <div class="entry-content">
    <p> Aliyun OSS (Object Storage Service) Go SDK is a client SDK to access Aliyun OSS API, implemented in the Go programming language.
Installation go get -u github.com/aliyun/aliyun-oss-go-sdk/oss go test -v -cover github.com/aliyun/aliyun-oss-go-sdk/oss Highlights Complete set of Aliyun OSS API Thouroughly tested 100% test coverage intuitive table driven tests full test suite completes within 2 seconds Lint clean golint go fmt goimports go vet race detector Idiomatic &amp; elegant response is returned as a parsed object error is returned as a Go error named options for setting headers &amp; parameters Great extensibility clean and orthogonal implementation users can easily extend the SDK when a new API method is supported No third party dependencies Documentation Overview API Object Bucket Object Optional Headers and Parameters Multipart Upload Cross-Origin Resource Sharing (CORS) Object Lifecycle Management Extending the SDK Differences with Python SDK HTTP header User-Agent, e.g. aliyun-sdk-go/0.1.1 (Linux/3.16.0-51-generic/x86_64;go1.5.1) Go HTTP client does not support 100-Continue (will be supported after Go 1.6, see https://github.com/golang/go/issues/3665) HTTP header keys are automatically converted into canonical format, e.g. x-oss-acl becomes X-Oss-Acl Go GET request does not have redundant “Content-Length: 0” header Parameters will be omitted if the argument is not set Go always sends URL parameters and headers in canonical order License licensed under the Apache License 2.0
...</p>
  </div>
  <footer class="entry-footer"><span title='2015-10-22 15:32:58 +0800 +0800'>October 22, 2015</span></footer>
  <a class="entry-link" aria-label="post link to Aliyun OSS Go SDK" href="http://h12.io/project/aliyun-oss-go-sdk/"></a>
</article>

<article class="post-entry tag-entry"> 
  <header class="entry-header">
    <h2 class="entry-hint-parent">kpax: a modular &amp; idiomatic Kafka client in Go
    </h2>
  </header>
  <div class="entry-content">
    <p>
Install go get -u h12.io/kpax Talk I gave a talk about Kpax at Gopher Meetup Shanghai 2016. See the slides.
Design The client is built on top of Kafka Wire Protocol (i.e. low-level API). The protocol related types &amp; marshal/unmarshal functions are automatically generated by wipro from the HTML spec).
(-) means to be done.
Sub packages model is an abstraction model for request, response, broker and cluster broker is a lazy, asynchronous and recoverable round tripper that talks to a single Kafka broker cluster is a metadata manager that talks to a Kafka cluster proto contains both low level API and a “middle” level facade producer: fault tolerant high-level producer (batching and partitioning strategy) consumer: fault tolerant high-level consumer (consumer group and offset commit) log: replaceable global logger cmd kpax: command line tool to help with Kafka programming Compatibility Compatible with Kafka Server 0.8.2.
...</p>
  </div>
  <footer class="entry-footer"><span title='2015-07-23 13:36:25 +0800 +0800'>July 23, 2015</span></footer>
  <a class="entry-link" aria-label="post link to kpax: a modular & idiomatic Kafka client in Go" href="http://h12.io/project/kpax/"></a>
</article>
<footer class="page-footer">
  <nav class="pagination">
    <a class="next" href="http://h12.io/tags/golang/page/2/">Next&nbsp;&nbsp;»
    </a>
  </nav>
</footer>
    </main>
    
<a href="#top" aria-label="go to top" title="Go to Top (Alt + G)" class="top-link" id="top-link" accesskey="g">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentColor">
        <path d="M12 6H0l6-6z" />
    </svg>
</a>
<footer class="footer">
        <p>&copy; 2012-2025, <span class="my-name">Hǎi-Liàng "Hal" Wáng</span>.</p>
        <p xmlns:cc="http://creativecommons.org/ns#" xmlns:dct="http://purl.org/dc/terms/"><span property="dct:title">The content of this page</span> is licensed under <a href="https://creativecommons.org/licenses/by/4.0/?ref=chooser-v1" target="_blank" rel="license noopener noreferrer" style="display:inline-flex;align-items:center;">CC BY 4.0<img style="height:22px!important;margin-left:3px;vertical-align:text-bottom;" src="https://mirrors.creativecommons.org/presskit/icons/cc.svg?ref=chooser-v1" alt=""><img style="height:22px!important;margin-left:3px;vertical-align:text-bottom;" src="https://mirrors.creativecommons.org/presskit/icons/by.svg?ref=chooser-v1" alt=""></a></p>
    </footer>


<script>
    let menu = document.getElementById('menu')
    if (menu) {
        menu.scrollLeft = localStorage.getItem("menu-scroll-position");
        menu.onscroll = function () {
            localStorage.setItem("menu-scroll-position", menu.scrollLeft);
        }
    }

    document.querySelectorAll('a[href^="#"]').forEach(anchor => {
        anchor.addEventListener("click", function (e) {
            e.preventDefault();
            var id = this.getAttribute("href").substr(1);
            if (!window.matchMedia('(prefers-reduced-motion: reduce)').matches) {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView({
                    behavior: "smooth"
                });
            } else {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView();
            }
            if (id === "top") {
                history.replaceState(null, null, " ");
            } else {
                history.pushState(null, null, `#${id}`);
            }
        });
    });

</script>
<script>
    var mybutton = document.getElementById("top-link");
    window.onscroll = function () {
        if (document.body.scrollTop > 800 || document.documentElement.scrollTop > 800) {
            mybutton.style.visibility = "visible";
            mybutton.style.opacity = "1";
        } else {
            mybutton.style.visibility = "hidden";
            mybutton.style.opacity = "0";
        }
    };

</script>
<script>
    document.getElementById("theme-toggle").addEventListener("click", () => {
        if (document.body.className.includes("dark")) {
            document.body.classList.remove('dark');
            localStorage.setItem("pref-theme", 'light');
        } else {
            document.body.classList.add('dark');
            localStorage.setItem("pref-theme", 'dark');
        }
    })

</script>
</body>

</html>
