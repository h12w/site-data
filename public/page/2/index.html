<!DOCTYPE html>
<html lang="en">
    <head>
	<meta name="generator" content="Hugo 0.53" />
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <title> Hai-Liang &#34;Hal&#34; Wang </title>
        <link rel="shortcut icon" href="/img/favicon.png" />

        <style>
            html,body,div,span,applet,object,iframe,h1,h2,h3,h4,h5,h6,p,blockquote,pre,a,abbr,acronym,address,big,cite,code,del,dfn,em,img,ins,kbd,q,s,samp,small,strike,strong,sub,sup,tt,var,b,u,i,center,dl,dt,dd,ol,ul,li,fieldset,form,label,legend,table,caption,tbody,tfoot,thead,tr,th,td,article,aside,canvas,details,embed,figure,figcaption,footer,header,hgroup,menu,nav,output,ruby,section,summary,time,mark,audio,video{margin:0;padding:0;border:0;font:inherit;font-size:100%;vertical-align:baseline}html{line-height:1}ol,ul{list-style:none}table{border-collapse:collapse;border-spacing:0}caption,th,td{text-align:left;font-weight:normal;vertical-align:middle}q,blockquote{quotes:none}q:before,q:after,blockquote:before,blockquote:after{content:"";content:none}a img{border:none}article,aside,details,figcaption,figure,footer,header,hgroup,main,menu,nav,section,summary{display:block}@font-face{font-family:'Alegreya';font-style:normal;font-weight:400;src:url("/font/Alegreya400normal.ttf") format("truetype"),url("/font/Alegreya400normal.woff") format("woff"),url("/font/Alegreya400normal.eot") format("embedded-opentype")}@font-face{font-family:'Alegreya';font-style:italic;font-weight:400;src:url("/font/Alegreya400italic.ttf") format("truetype"),url("/font/Alegreya400italic.woff") format("woff"),url("/font/Alegreya400italic.eot") format("embedded-opentype")}@font-face{font-family:'Alegreya';font-style:normal;font-weight:700;src:url("/font/Alegreya700normal.ttf") format("truetype"),url("/font/Alegreya700normal.woff") format("woff"),url("/font/Alegreya700normal.eot") format("embedded-opentype")}@font-face{font-family:'Open Sans Condensed';font-style:normal;font-weight:300;src:url("/font/OpenSansCondensed300normal.ttf") format("truetype"),url("/font/OpenSansCondensed300normal.woff") format("woff"),url("/font/OpenSansCondensed300normal.eot") format("embedded-opentype")}@font-face{font-family:'Open Sans Condensed';font-style:italic;font-weight:300;src:url("/font/OpenSansCondensed300italic.ttf") format("truetype"),url("/font/OpenSansCondensed300italic.woff") format("woff"),url("/font/OpenSansCondensed300italic.eot") format("embedded-opentype")}html{font-size:118.75%;line-height:1.57895em}*,*:before,*:after{-moz-box-sizing:border-box;-webkit-box-sizing:border-box;box-sizing:border-box}html{font-family:Alegreya,sans-serif;background:#262626;color:#d9d9d9;-webkit-transform:translate3d(0, 0, 0)}.container{max-width:43.75rem;margin-left:auto;margin-right:auto}.container:after{content:" ";display:block;clear:both}h1,h2,h3,h4,h5,h6{font-family:"Open Sans Condensed",sans}a{text-decoration:none}a{color:#75A6C4}a:hover{color:#a9c8da;text-decoration:none}em{font-style:italic}strong{color:#fff}code{font-family:Menlo,Consolas,"Ubuntu Mono",monospace,sans;background-color:#1a1a1a;-moz-border-radius:5px;-webkit-border-radius:5px;border-radius:5px;font-size:.89474rem;line-height:1.57895rem;white-space:pre}p code,li code{padding:0.15rem}pre code{word-wrap:break-word;white-space:pre-wrap;padding-left:0.5rem;padding-right:0.5rem;display:block}code.mathjax{-webkit-font-smoothing:antialiased;background:inherit !important;border:none !important;font-size:100%}table{font-family:Menlo,Consolas,"Ubuntu Mono",monospace,sans;border:1px solid #8c8c8c;margin-left:auto;margin-right:auto}thead,tfoot{border:1px solid #8c8c8c}th,td{padding:0.1rem 0.5rem;text-align:center;background-color:#1a1a1a}#logo{float:left;padding-left:.78947rem;line-height:2.36842rem;height:2.36842rem}@font-face{font-family:'icon';src:url("../font/icon.eot?15086725");src:url("../font/icon.eot?15086725#iefix") format("embedded-opentype"),url("../font/icon.woff2?15086725") format("woff2"),url("../font/icon.woff?15086725") format("woff"),url("../font/icon.ttf?15086725") format("truetype"),url("../font/icon.svg?15086725#icon") format("svg");font-weight:normal;font-style:normal}[class^="icon-"]:before,[class*=" icon-"]:before{font-family:"icon";font-style:normal;font-weight:normal;speak:none;display:inline-block;text-decoration:inherit;width:1em;margin-right:.2em;text-align:center;font-variant:normal;text-transform:none;line-height:1em;margin-left:.2em;-webkit-font-smoothing:antialiased;-moz-osx-font-smoothing:grayscale}.icon-article:before{content:'󰀀'}.icon-project:before{content:'󰀁'}.icon-note:before{content:'󰀂'}.icon-slide:before{content:'󰀃'}.icon-about:before{content:'󰀄'}.icon-menu:before{content:'󰀅'}nav{padding-left:.78947rem;padding-right:.78947rem;padding-top:0;padding-bottom:0}#nav-toggle-check{display:none}#nav-toggle-check:checked ~ #nav-toggle-button{color:#fefefe}#nav-toggle-check:checked ~ #nav-content{-moz-transition:all 300ms;-o-transition:all 300ms;-webkit-transition:all 300ms;transition:all 300ms;max-height:12.63158rem}#nav-toggle-button{float:right;font-size:25px;line-height:2.36842rem;height:2.36842rem}@media (min-width: 45em){#nav-toggle-button{display:none}}#nav-toggle-button:hover{color:#fefefe;cursor:pointer}#nav-content{clear:both;max-height:0}@media (min-width: 30em) and (max-width: 45em){#nav-content{text-align:center}}@media (min-width: 45em){#nav-content{clear:none;float:right;-moz-transition:all 300ms;-o-transition:all 300ms;-webkit-transition:all 300ms;transition:all 300ms;max-height:12.63158rem}}#nav-links{display:inline}@media (min-width: 30em){#nav-links{line-height:2.36842rem}}#nav-links h2{display:block;margin-top:0;margin-left:0;margin-right:0}@media (min-width: 30em){#nav-links h2{display:inline;margin-top:0;margin-bottom:0;margin-left:0.5rem;margin-right:0.5rem}}.nav-search-form{padding-bottom:.78947rem;position:relative;top:0}@media (min-width: 30em) and (max-width: 45em){.nav-search-form{margin-left:auto;margin-right:auto}}@media (min-width: 45em){.nav-search-form{display:inline-block;margin-left:0.5rem;padding-bottom:0;top:-0.1rem}}.nav-search-box{min-width:128px;height:1.2rem;background-color:#404040;color:#d9d9d9;font-size:15px;padding:0.2rem 0.4rem;border:1px solid #d9d9d9;outline:0px none;border-radius:3px;background-image:url("/img/cse.png");background-size:119px 16px;background-repeat:no-repeat;background-position:left 0.2rem center}@media (min-width: 45em){.nav-search-box{width:128px}}.nav-search-box:hover,.nav-search-box:focus,.nav-search-box:valid{border-color:#fefefe;background-image:none;box-shadow:0px 1px 1px rgba(0,0,0,0.075) inset,0px 0px 8px #fefefe}#top-header{overflow:hidden;*zoom:1;position:fixed;top:0;z-index:9999;width:100%;background:#404040}#top-header h1{font-size:25px}#top-header h2{font-size:19px;font-family:"Open Sans Condensed",sans}#top-header h1 strong{color:#FF7F00;font-family:Alegreya,sans-serif}#top-header a{color:#d9d9d9}#top-header a:hover{color:#fefefe}main{padding-top:3.15789rem;max-width:43.75rem;margin-left:auto;margin-right:auto;padding-left:.78947rem;padding-right:.78947rem}main:after{content:" ";display:block;clear:both}article ul{list-style:disc outside}article ol{list-style-type:decimal}article ul,article ol{margin-left:2.76316rem;margin-right:2.76316rem}article pre{margin-left:1.57895rem;margin-right:1.57895rem}article p{margin-top:1.57895rem}article .time{display:block;font-size:1rem;line-height:1.57895rem;font-family:"Open Sans Condensed",sans;color:#999}article h1{margin-top:1.57895rem;font-size:2.05263rem;line-height:3.15789rem}article h2{margin-top:1.57895rem;font-size:1.57895rem;line-height:1.57895rem;margin-bottom:1.57895rem}article h3{margin-top:1.57895rem;font-size:1.21053rem;line-height:1.57895rem;margin-bottom:1.57895rem}article h4{font-size:1.05263rem;line-height:1.57895rem}article h5{font-size:1.05263rem;line-height:1.57895rem}article h6{font-size:1.05263rem;line-height:1.57895rem}.hyphenate p,.hyphenate ul,.hyphenate ol{-moz-hyphens:auto;-ms-hyphens:auto;-webkit-hyphens:auto;hyphens:auto}body.css-hyphens .hyphenate p,body.css-hyphens .hyphenate ul,body.css-hyphens .hyphenate ol{text-align:justify}article.single h1{color:#fff;text-align:center;margin-bottom:1.57895rem}article.frontpage .article-body{margin-left:1.57895rem;margin-right:1.57895rem}article.frontpage h1{position:relative}article.frontpage h1 span.line{position:absolute;display:block;width:100%;margin:0;border:0;border-top:0.056rem solid rgba(38,38,38,0.5);border-bottom:0.056rem solid rgba(217,217,217,0.2)}article.frontpage .time{margin-bottom:1.57895rem}article.list h2{margin-top:1.57895rem;font-size:1.31579rem;line-height:1.57895rem;margin-bottom:0rem}h1.list{margin-top:1.57895rem;font-size:1.73684rem;line-height:1.57895rem;margin-bottom:1.57895rem}p#more{font-family:"Open Sans Condensed",sans;font-size:1.31579rem;line-height:1.57895rem;font-style:italic;margin-top:1.57895rem}#site-footer{margin-top:1.57895rem;margin-bottom:.3125rem;text-align:center;font-size:.89474rem;line-height:1.57895rem}#site-footer hr{border:0;height:1px;background-image:url('data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0idXRmLTgiPz4gPHN2ZyB2ZXJzaW9uPSIxLjEiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+PGRlZnM+PGxpbmVhckdyYWRpZW50IGlkPSJncmFkIiBncmFkaWVudFVuaXRzPSJvYmplY3RCb3VuZGluZ0JveCIgeDE9IjAuMCIgeTE9IjAuNSIgeDI9IjEuMCIgeTI9IjAuNSI+PHN0b3Agb2Zmc2V0PSIwJSIgc3RvcC1jb2xvcj0iIzI2MjYyNiIvPjxzdG9wIG9mZnNldD0iNTAlIiBzdG9wLWNvbG9yPSIjZDlkOWQ5IiBzdG9wLW9wYWNpdHk9IjAuMzgyIi8+PHN0b3Agb2Zmc2V0PSIxMDAlIiBzdG9wLWNvbG9yPSIjMjYyNjI2Ii8+PC9saW5lYXJHcmFkaWVudD48L2RlZnM+PHJlY3QgeD0iMCIgeT0iMCIgd2lkdGg9IjEwMCUiIGhlaWdodD0iMTAwJSIgZmlsbD0idXJsKCNncmFkKSIgLz48L3N2Zz4g');background-size:100%;background-image:-webkit-gradient(linear, 0% 50%, 100% 50%, color-stop(0%, #262626),color-stop(50%, rgba(217,217,217,0.382)),color-stop(100%, #262626));background-image:-moz-linear-gradient(left, #262626,rgba(217,217,217,0.382),#262626);background-image:-webkit-linear-gradient(left, #262626,rgba(217,217,217,0.382),#262626);background-image:linear-gradient(to right, #262626,rgba(217,217,217,0.382),#262626)}div.gsc-adBlock,#discovery-top{display:none !important}.cse .gsc-control-cse,.gsc-control-cse{background-color:#262626 !important;border:none !important}.gs-result .gs-title,.gs-result .gs-title *{color:#75A6C4 !important;text-decoration:none !important}.gs-result .gs-title:hover,.gs-result .gs-title *:hover{text-decoration:underline !important}.gsc-preview-reviews,.gsc-control-cse .gs-snippet,.gsc-control-cse .gs-promotion em,.gsc-control-cse .gs-snippet,.gsc-control-cse .gs-promotion em,.gsc-result-info,.gsc-orderby-label{color:#d9d9d9 !important}.gsc-webResult.gsc-result{border:none !important}.gsc-above-wrapper-area{border-bottom:none !important}.gsc-control-cse,.gsc-control-cse *{box-sizing:content-box}.gsc-result .gs-title{height:auto !important}.gsc-selected-option-container{background-color:#262626 !important;background-image:url('data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0idXRmLTgiPz4gPHN2ZyB2ZXJzaW9uPSIxLjEiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+PGRlZnM+PGxpbmVhckdyYWRpZW50IGlkPSJncmFkIiBncmFkaWVudFVuaXRzPSJvYmplY3RCb3VuZGluZ0JveCIgeDE9IjAuNSIgeTE9IjAuMCIgeDI9IjAuNSIgeTI9IjEuMCI+PHN0b3Agb2Zmc2V0PSIwJSIgc3RvcC1jb2xvcj0iIzI2MjYyNiIvPjxzdG9wIG9mZnNldD0iMTAwJSIgc3RvcC1jb2xvcj0iIzQwNDA0MCIvPjwvbGluZWFyR3JhZGllbnQ+PC9kZWZzPjxyZWN0IHg9IjAiIHk9IjAiIHdpZHRoPSIxMDAlIiBoZWlnaHQ9IjEwMCUiIGZpbGw9InVybCgjZ3JhZCkiIC8+PC9zdmc+IA==') !important;background-size:100%;background-image:-webkit-gradient(linear, 50% 0%, 50% 100%, color-stop(0%, #262626),color-stop(100%, #404040)) !important;background-image:-moz-linear-gradient(top, #262626,#404040) !important;background-image:-webkit-linear-gradient(top, #262626,#404040) !important;background-image:linear-gradient(to bottom, #262626,#404040) !important}.gsc-selected-option-container{color:#d9d9d9 !important}.gsc-control-cse .gsc-option-menu{background:#262626 !important;border:1px solid rgba(38,38,38,0.2);box-shadow:0 2px 4px #262626}.gsc-option-menu-item{color:#d9d9d9 !important}.gsc-option-menu-item-highlighted{background-color:#404040 !important;border-color:#d9d9d9 !important;color:#d9d9d9 !important}.gsc-results .gsc-cursor-box .gsc-cursor-current-page{color:#75A6C4 !important;cursor:pointer !important;background-color:#262626 !important}.gs-result a.gs-visibleUrl,.gs-result .gs-visibleUrl{color:forestgreen !important}.gsc-result-info{padding-top:.78947rem !important;padding-bottom:.78947rem !important}.cse .gsc-control-cse,.gsc-control-cse,.gsc-above-wrapper-area,.gcsc-branding,.gsc-results,.gs-result a.gs-visibleUrl,.gs-result .gs-visibleUrl,.gsc-table-result,.gsc-thumbnail-inside,.gsc-url-top{padding:0 !important}td.gcsc-branding-text div.gcsc-branding-text{margin:0 !important;padding:0 !important}img.gsc-branding-img,img.gsc-branding-img-noclear,img.gcsc-branding-img,img.gcsc-branding-img-noclear{vertical-align:middle !important}.gsc-webResult .gsc-result{background-color:#262626 !important;padding-top:1.57895rem !important;padding-bottom:0 !important}.gsc-results .gsc-cursor-box{margin-top:1.57895rem !important;margin-bottom:1.57895rem !important}.hljs,.hljs-tag,.css .hljs-rules,.css .hljs-value,.css .hljs-function .hljs-preprocessor,.hljs-pragma{color:#d9d9d9}.hljs-strongemphasis,.hljs-strong,.hljs-emphasis{color:#a8a8a2}.hljs-bullet,.hljs-blockquote,.hljs-horizontal_rule,.hljs-number,.hljs-regexp,.alias .hljs-keyword,.hljs-literal,.hljs-hexcolor{color:#ae81ff}.hljs-tag .hljs-value,.hljs-code,.hljs-title,.css .hljs-class,.hljs-class .hljs-title:last-child{color:#a6e22e}.hljs-link_url{font-size:80%}.hljs-strong,.hljs-strongemphasis{font-weight:bold}.hljs-emphasis,.hljs-strongemphasis,.hljs-class .hljs-title:last-child{font-style:italic}.hljs-keyword,.hljs-function,.hljs-change,.hljs-winutils,.hljs-flow,.lisp .hljs-title,.clojure .hljs-built_in,.nginx .hljs-title,.tex .hljs-special,.hljs-header,.hljs-attribute,.hljs-symbol,.hljs-symbol .hljs-string,.hljs-tag .hljs-title,.hljs-value,.alias .hljs-keyword:first-child,.css .hljs-tag,.css .unit,.css .hljs-important{color:#D12060}.hljs-function .hljs-keyword,.hljs-class .hljs-keyword:first-child,.hljs-constant,.css .hljs-attribute{color:#66d9ef}.hljs-variable,.hljs-params,.hljs-class .hljs-title{color:#f8f8f2}.hljs-string,.css .hljs-id,.hljs-subst,.haskell .hljs-type,.ruby .hljs-class .hljs-parent,.hljs-built_in,.django .hljs-template_tag,.django .hljs-variable,.smalltalk .hljs-class,.django .hljs-filter .hljs-argument,.smalltalk .hljs-localvars,.smalltalk .hljs-array,.hljs-attr_selector,.hljs-pseudo,.hljs-addition,.hljs-stream,.hljs-envvar,.apache .hljs-tag,.apache .hljs-cbracket,.tex .hljs-command,.hljs-prompt,.hljs-link_label,.hljs-link_url{color:#e6db74}.hljs-comment,.hljs-javadoc,.java .hljs-annotation,.python .hljs-decorator,.hljs-template_comment,.hljs-pi,.hljs-doctype,.hljs-deletion,.hljs-shebang,.apache .hljs-sqbracket,.tex .hljs-formula{color:#75715e}.coffeescript .javascript,.javascript .xml,.tex .hljs-formula,.xml .javascript,.xml .vbscript,.xml .css,.xml .hljs-cdata,.xml .php,.php .xml{opacity:0.5}ul#tags{font-family:"Open Sans Condensed",sans;clear:both;list-style:none;line-height:3.15789rem;padding:0}@media (min-width: 45em){ul#tags{clear:none}}ul#tags li{float:left;line-height:1.26316rem;margin-top:.94737rem;margin-left:0.4rem}@media (min-width: 45em){ul#tags li{float:right}}ul#tags li a{font-size:17px;color:#000;background:#75A6C4;border-radius:3px;padding-left:0.2rem;padding-right:0.2rem;padding-bottom:0.1rem;cursor:pointer}ul#tags li a:hover{background:#a9c8da;outline:none}#article-time{float:left;font-family:"Open Sans Condensed",sans;font-size:1.31579rem;line-height:3.15789rem;color:#999}#livefyre-comments{padding-top:3.15789rem;font-family:"Open Sans Condensed",sans}#livefyre-comments p{font-family:Alegreya,sans-serif}#livefyre-comments .fyre .fyre-help{display:none}#livefyre-comments .fyre .fyre-login-bar{font-family:inherit}#livefyre-comments .fyre .fyre-comment-article,#livefyre-comments .fyre .fyre-comment-stream{font-family:inherit;font-size:1rem;line-height:1.57895rem;margin:0}#livefyre-comments .fyre .fyre-comment{margin:0}#livefyre-comments .fyre .fyre-comment p{margin-bottom:1.57895rem;line-height:1.57895rem}#livefyre-comments .fyre .fyre-comment p:last-child{margin-bottom:0}#livefyre-comments .fyre .fyre-comment a.fyre-comment-edit{font-size:17px}#livefyre-comments .fyre .fyre-comment-footer{margin:0;padding:0;line-height:1.57895rem;height:1.57895rem;font-family:"Open Sans Condensed",sans}#livefyre-comments .fyre .fyre-comment-actions{margin-top:0;font-size:17px}#livefyre-comments .fyre .fyre-comment-actions a:hover{text-decoration:none}#livefyre-comments .fyre .fyre-comment-like,#livefyre-comments .fyre .fyre-comment-reply,#livefyre-comments .fyre .fyre-comment-like-count,#livefyre-comments .fyre .fyre-comment-like-btn{font-size:17px}#livefyre-comments .fyre .fyre-stream-stats span{line-height:1.57895rem}#livefyre-comments .fyre .fyre-stream-stats .fyre-comment-count{font-family:inherit;font-weight:normal;font-size:1.31579rem;line-height:1.57895rem}#livefyre-comments .fyre .fyre-livecount{top:auto;position:static}#livefyre-comments .fyre .fyre-auth{margin-top:1.57895rem}#livefyre-comments .fyre .fyre-stream-stats,#livefyre-comments .fyre .fyre-box-wrapper a.fyre-user-profile-link,#livefyre-comments .fyre .fyre-stream-livecount,#livefyre-comments .fyre .fyre-comment-stream,#livefyre-comments .fyre .fyre-comment-actions{color:#d9d9d9}#livefyre-comments .fyre .fyre-box-wrapper:hover{background:none}#livefyre-comments .fyre .fyre-box-list{background:none repeat scroll 0% 0% #262626;color:#d9d9d9}#livefyre-comments .fyre .fyre-box-list li a{color:#d9d9d9}#livefyre-comments .fyre .fyre-box-list li a:hover{color:#262626;background-color:#d9d9d9}#livefyre-comments .fyre .fyre-user-loggedout{color:#d9d9d9}#livefyre-comments .fyre .fyre-user-loggedout,#livefyre-comments .fyre .fyre-stream-sort,#livefyre-comments .fyre .fyre-stream-stats,#livefyre-comments .fyre .fyre-stream-livecount{font-family:inherit;font-size:17px;line-height:1.57895rem}#livefyre-comments .fyre .fyre-moderator{display:none}#livefyre-comments .fyre a{color:#75A6C4}#livefyre-comments .fyre a:hover{color:#a9c8da}#livefyre-comments .fyre .fyre-stream-sort{border:none;margin:0;padding-top:.78947rem;padding-bottom:.78947rem;line-height:1.57895rem}#livefyre-comments .fyre .fyre-comment-article{margin-top:1.57895rem}#livefyre-comments .fyre .fyre-comment-head{position:relative}#livefyre-comments .fyre .fyre-comment-head .fyre-comment-username::before{content:"";position:absolute;width:100%;height:0px;background:none;border:0;border-top:0.056rem solid rgba(38,38,38,0.5);border-bottom:0.056rem solid rgba(217,217,217,0.2)}#livefyre-comments .fyre .fyre-comment-divider{display:none}#livefyre-comments .fyre .fyre-comment-wrapper time.fyre-comment-date{font-size:17px}#livefyre-comments .fyre-editor{margin:0;padding-top:2.36842rem}#livefyre-comments .fyre-editor .fyre-editor-container .fyre-editor-editable{color:#d9d9d9;background-color:transparent;font-family:inherit;font-size:1rem;line-height:1.57895rem;overflow:hidden;padding:.78947rem}#livefyre-comments .fyre-editor .fyre-editor-container .fyre-editor-editable p{line-height:1.5}#livefyre-comments .fyre-editor .fyre-editor-toolbar{height:60px}#livefyre-comments .fyre-editor .fyre-editor-toolbar .goog-toolbar>div{color:#d9d9d9;background-image:url('data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0idXRmLTgiPz4gPHN2ZyB2ZXJzaW9uPSIxLjEiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+PGRlZnM+PGxpbmVhckdyYWRpZW50IGlkPSJncmFkIiBncmFkaWVudFVuaXRzPSJvYmplY3RCb3VuZGluZ0JveCIgeDE9IjAuNSIgeTE9IjAuMCIgeDI9IjAuNSIgeTI9IjEuMCI+PHN0b3Agb2Zmc2V0PSIwJSIgc3RvcC1jb2xvcj0iIzI2MjYyNiIvPjxzdG9wIG9mZnNldD0iMTAwJSIgc3RvcC1jb2xvcj0iIzNiM2IzYiIvPjwvbGluZWFyR3JhZGllbnQ+PC9kZWZzPjxyZWN0IHg9IjAiIHk9IjAiIHdpZHRoPSIxMDAlIiBoZWlnaHQ9IjEwMCUiIGZpbGw9InVybCgjZ3JhZCkiIC8+PC9zdmc+IA==');background-size:100%;background-image:-webkit-gradient(linear, 50% 0%, 50% 100%, color-stop(0%, #262626),color-stop(100%, #3b3b3b));background-image:-moz-linear-gradient(top, #262626,#3b3b3b);background-image:-webkit-linear-gradient(top, #262626,#3b3b3b);background-image:linear-gradient(to bottom, #262626,#3b3b3b)}#livefyre-comments .fyre-editor .fyre-editor-toolbar .goog-toolbar>div.fyre-format-button{display:none}#livefyre-comments .fyre-editor .fyre-editor-toolbar .goog-toolbar>div.fyre-mention-button{border-bottom:1px solid #a1a1a1;border-left:1px solid #a1a1a1;-moz-border-radius:0 0 0 5px;-webkit-border-radius:0;border-radius:0 0 0 5px}#livefyre-comments .fyre-editor .fyre-editor-toolbar .goog-toolbar>div.fyre-mention-button>div{background:url("/img/sprites.png") no-repeat scroll 9px -57px transparent}#livefyre-comments .fyre-editor .fyre-editor-toolbar .goog-toolbar>div.fyre-embed-button>div{background:url("/img/sprites.png") no-repeat scroll 8px -121px transparent}#livefyre-comments .fyre-editor .fyre-editor-toolbar .goog-toolbar>div.fyre-button-left .fyre-button-left-outer-box .fyre-button-left-inner-box{text-shadow:none}#livefyre-comments .fyre-editor .fyre-editor-toolbar .goog-toolbar>div.fyre-button-right.fyre-post-button .fyre-button-right-outer-box .fyre-button-right-inner-box{color:#d9d9d9;text-shadow:none}#livefyre-comments .fyre-editor .fyre-editor-toolbar .fyre-share-container{background-color:#262626}#livefyre-comments .fyre-editor .fyre-editor-toolbar .fyre-share-container span>a{color:#d9d9d9}#livefyre-comments .fyre-editor .fyre-editor-toolbar .fyre-share-container span>a:hover{color:#262626;background-color:#d9d9d9}#livefyre-comments .fyre-editor .fyre-editor-toolbar .fyre-format-toolbar{background-color:#262626}#livefyre-comments .fyre-editor .fyre-editor-toolbar .fyre-mention-menu{background-color:#262626}#livefyre-comments .fyre-editor .fyre-editor-toolbar .fyre-mention-menu .fyre-mention-item{height:auto}.my-name{font-family:Constantia,"Lucida Bright",Lucidabright,"Lucida Serif",Lucida,"DejaVu Serif","Bitstream Vera Serif","Liberation Serif",Georgia,serif;font-size:90%}#github-ribbon{position:fixed;width:200px;top:2.36842rem;margin-top:34px;right:-50px;-moz-transform:rotate(45deg);-ms-transform:rotate(45deg);-webkit-transform:rotate(45deg);transform:rotate(45deg);background-color:#FF7F00;background-image:url('data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0idXRmLTgiPz4gPHN2ZyB2ZXJzaW9uPSIxLjEiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+PGRlZnM+PGxpbmVhckdyYWRpZW50IGlkPSJncmFkIiBncmFkaWVudFVuaXRzPSJvYmplY3RCb3VuZGluZ0JveCIgeDE9IjAuNSIgeTE9IjAuMCIgeDI9IjAuNSIgeTI9IjEuMCI+PHN0b3Agb2Zmc2V0PSIwJSIgc3RvcC1jb2xvcj0iIzAwMDAwMCIgc3RvcC1vcGFjaXR5PSIwLjAiLz48c3RvcCBvZmZzZXQ9IjEwMCUiIHN0b3AtY29sb3I9IiMwMDAwMDAiIHN0b3Atb3BhY2l0eT0iMC4xNSIvPjwvbGluZWFyR3JhZGllbnQ+PC9kZWZzPjxyZWN0IHg9IjAiIHk9IjAiIHdpZHRoPSIxMDAlIiBoZWlnaHQ9IjEwMCUiIGZpbGw9InVybCgjZ3JhZCkiIC8+PC9zdmc+IA==');background-size:100%;background-image:-webkit-gradient(linear, 50% 0%, 50% 100%, color-stop(0%, rgba(0,0,0,0)),color-stop(100%, rgba(0,0,0,0.15)));background-image:-moz-linear-gradient(top, rgba(0,0,0,0),rgba(0,0,0,0.15));background-image:-webkit-linear-gradient(top, rgba(0,0,0,0),rgba(0,0,0,0.15));background-image:linear-gradient(to bottom, rgba(0,0,0,0),rgba(0,0,0,0.15));font-family:HelveticaNeue,"Helvetica Neue",HelveticaNeueRoman,HelveticaNeue-Roman,"Helvetica Neue Roman",TeXGyreHerosRegular,Helvetica,Tahoma,Geneva,Arial,sans-serif;font-weight:bold;font-size:15px;padding:2px 0;z-index:10;pointer-events:auto}#github-ribbon a,#github-ribbon a:hover{color:#404040;text-decoration:none;display:inline-block;text-align:center;width:200px;border-width:1px 0;border-style:dashed;border-color:#404040}.pagination{font-family:"Open Sans Condensed",sans;font-weight:bold;margin-top:3rem;text-align:center}.pagination li{display:inline;margin-left:0.5rem;margin-right:0.5rem}.pagination .disabled{color:#999}

        </style>

        <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/8.0/highlight.min.js"></script>
<script>
    hljs.configure({languages: []}); 
    hljs.initHighlightingOnLoad();
</script>


        <script>
  MathJax = {
    tex: {
      inlineMath: [['$', '$'], ['\\(', '\\)']],
      displayMath: [['$$','$$'], ['\\[', '\\]']],
      processEscapes: true,
      processEnvironments: true
    },
    options: {
      enableMenu: false,
      skipHtmlTags: ['script', 'noscript', 'style', 'textarea', 'pre']
    }
  };
</script>
<script src="//polyfill.io/v3/polyfill.min.js?features=es6"></script>
<script type="text/javascript" id="MathJax-script" async src="//cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>


    </head>
    <body>
        <header id="top-header">
            <div class="container">
                <h1 id="logo">
                    
                    <a rel="home" id="site-title" href="/"><strong>h12</strong></a>
                    <a href="https://stand-with-ukraine.pp.ua"><img src="https://raw.githubusercontent.com/vshymanskyy/StandWithUkraine/main/badges/StandWithUkraine.svg" alt="Stand With Ukraine"></a>
                </h1>
                <nav>
                    <input type="checkbox" id="nav-toggle-check">
                    <label id="nav-toggle-button" for="nav-toggle-check" class="icon-menu"></label>
                    <div id="nav-content">
                        <div id="nav-links">
                            <h2><a href="/article" data-nav="Article">
                                <i class="icon-article"></i><span>Article</span>
                            </a></h2>
                            <h2><a href="/project" data-nav="Project">
                                <i class="icon-project"></i><span>Project</span>
                            </a></h2>
                            <h2><a href="/note" data-nav="Note">
                                <i class="icon-note"></i><span>Note</span>
                            </a></h2>
                            
                            <h2><a href="/about" data-nav="About">
                                <i class="icon-about"></i><span>About</span>
                            </a></h2>
                        </div>
                        <form class="nav-search-form" action="/search">
                            <input type="text" class="nav-search-box" name="q" required="required"/>
                        </form>
                    </div>
                </nav>
            </div>
        </header>


        <main class="container">
        
        
            <article class="frontpage">
                <h1>
                    <a href="http://h12.io/article/value-vs-pointer-receivers/">Value vs Pointer Receivers</a>
                    <span class="line"></span>
                </h1>
                <span class="time">19 June 2020</span>
                <div class="article-body hyphenate">
                    

<p>Should I use value receivers or pointer receivers?</p>

<p>Value receivers have some benefits include immutability, concurrent safety and clean logic (not always, often true). But to what extend can I use value receivers without an issue or performance penalty?</p>

<p>In the <a href="https://golang.org/doc/faq#methods_on_values_or_pointers">Go FAQ</a>, there
are 3 rules:</p>

<ol>
<li>most important, does the method need to modify the receiver? If it does, the receiver must be a pointer</li>
<li>if the receiver is large, a big struct for instance, it will be much cheaper to use a pointer receiver</li>
<li>if some of the methods of the type must have pointer receivers, the rest should too, so the method set is consistent regardless of how the type is used</li>
</ol>

<p>Let&rsquo;s look at rule 1. In many cases, an object needs to be modified by a method after its initialization, but it doesn’t mean the modification has to be done in place, an alternative and often a better way is to get a modified copy of the object, which is usually called a <a href="https://en.wikipedia.org/wiki/Fluent_interface">Fluent Interface</a>. Basically it means a method with a value receiver and a return value of the same type. It’s just pure (no side effect) functional programming style under another name.</p>

<p>Then rule 2 tells us to choose based on the struct size, but how big is a big struct? We know that <a href="https://golang.org/pkg/time/#Time"><code>time.Time</code></a> is 3-words large with value receivers, but how about 4-words, 5-words or bigger structs? To answer this question, I did some <a href="https://github.com/h12w/go-benchmark/blob/master/receiver_all_bench.bash">benchmarks</a>.</p>

<p>The benchmarks are based on the idea that a type with value receivers would need to implement fluent interface, so it should compare the performance between two fluent methods with value and pointer receivers:</p>

<pre><code class="language-go">func (s S) ByValue() S {
    // ...
	return s
}

func (s *S) ByPointer() *S {
    // ...
	return s
}
</code></pre>

<p>It turned out inlining is critical to the overhead of value copying.</p>

<p>When inlining is disabled (<code>gcflags=-l</code>), for a struct of 1 word, value receiver has the same performance as the pointer receiver, but for structs larger than 2 words, value receivers begin to show more and more overhead.</p>

<p><img src="/img/no_inline.png" alt="Without Inline" /></p>

<p>However, when inlining is enabled (the default option), value receivers have almost the same performance as pointer receivers for struct size from 1 up to 9 words! Overhead of value copying starts to rise for structs of 10 words or more.</p>

<p><img src="/img/with_inline.png" alt="With Inline" /></p>

<p>These results were tested on a Macbook Pro with <code>go1.14.3</code>.</p>

<h3 id="conclusion">Conclusion</h3>

<p>From the benchmark results, value receivers should be preferred if the methods are inlined and the struct size is equal to or smaller than 9 words (<code>1 word == 64 bit</code>), but this might not be the end of the story, the more complex a method is, the less likely it is inlined, but also the less proportion the copying overhead to the whole method logic. The overhead of copying from a value receiver might not be significant to the overall running time, so at the end of the day, the choice depends on the frequency of the method calls, the business logic and the performance requirements. When in doubt, benchmark it!</p>

                </div>
            </article>
        
            <article class="frontpage">
                <h1>
                    <a href="http://h12.io/note/go-vs-python/">Go vs Python</a>
                    <span class="line"></span>
                </h1>
                <span class="time">27 September 2019</span>
                <div class="article-body hyphenate">
                    

<h3 id="slices">Slices</h3>

<p>Go slice and Python slice have very similar syntax, but Python slice is a shallow copy of part of the original list, while Go slice is just a new range within the same underlying array of the original slice.</p>

<p>Let&rsquo;s try:</p>

<pre><code class="language-python">a = [1, 2, 3]
b = a[:2]
b[0] = 9
print(a)
print(b)

# output:
# [1, 2, 3]
# [9, 2]
</code></pre>

<p>See <code>a[0]</code> remains the same.</p>

<pre><code class="language-go">package main

import (
    &quot;fmt&quot;
)

func main() {
	a := []int{1, 2, 3}
	b := a[:2]
	b[0] = 9
	fmt.Println(a)
	fmt.Println(b)

	# output:
	# [9 2 3]
	# [9 2]
}
</code></pre>

<p>See <code>a[0]</code> changes because slice <code>a</code> and <code>b</code> shares the same underlying array.</p>

                </div>
            </article>
        
            <article class="frontpage">
                <h1>
                    <a href="http://h12.io/note/learn-frontend/">Learning Frontend</a>
                    <span class="line"></span>
                </h1>
                <span class="time">15 February 2019</span>
                <div class="article-body hyphenate">
                    <ul>
<li><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript">Vanilla JavaScript</a></li>
<li><a href="https://reactjs.org/docs/getting-started.html">React</a></li>
<li><a href="https://emotion.sh/docs/introduction">Emotion</a></li>
</ul>

                </div>
            </article>
        
            <article class="frontpage">
                <h1>
                    <a href="http://h12.io/note/js-surprises/">JavaScript Surprises to a Go Developer</a>
                    <span class="line"></span>
                </h1>
                <span class="time">12 February 2019</span>
                <div class="article-body hyphenate">
                    

<h3 id="the-scope-of-var-is-wrong">The scope of <code>var</code> is wrong</h3>

<p>Never use <code>var</code> to declare variables, use <code>let</code> instead.</p>

<p><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Guide/Grammar_and_types#Variables">REF</a></p>

<h3 id="is-conversion-and-comparison"><code>==</code> is conversion and comparison</h3>

<p>What you really need is <code>===</code>, which is similar to comparing two interface{}.</p>

<h3 id="is-shallow"><code>===</code> is shallow</h3>

<p><code>{a:1}==={a:1}</code> is <code>false</code>, while Go struct with string are compared by contents (but not for slice).</p>

<p>Also this affects map key comparison. So object key is not so useful in JS as
struct key in Go. The equality test is always on the references rather than the contents.</p>

<p><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Operators/Comparison_Operators#Inequality">REF</a></p>

<h3 id="const-works-for-objects-but-the-contents-are-modifiable"><code>const</code> works for objects, but the contents are modifiable</h3>

<p><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Guide/Grammar_and_types#Constants">REF</a></p>

<h3 id="single-and-double-quotes-are-the-same">Single and double quotes are the same</h3>

<p><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Guide/Grammar_and_types#String_literals">REF</a></p>

<h3 id="back-quotes-are-like-text-template">Back quotes are like text/template</h3>

<p>Escapes also works in back quotes and more template related features.</p>

<p><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Template_literals">REF</a></p>

<h3 id="switch-cases-fall-through-by-default">Switch cases fall through by default</h3>

<h3 id="access-undeclared-object-property-returns-undefined">Access undeclared object property returns <code>undefined</code></h3>

<p>Trying to access undeclared variables throws an exception but accessing undeclared
object properties return a value called <code>undefined</code>.</p>

<p>Use <code>'property' in obj</code> to check if a property is declared or not.</p>

<h3 id="only-float64-is-supported">Only float64 is supported</h3>

<h3 id="object-is-like-map-string-interface">Object is like map[string]interface{}</h3>

<h3 id="array-is-like-map-int-interface">Array is like map[int]interface{}</h3>

<h3 id="map-is-like-map-interface-interface">Map is like map[interface{}]interface{}</h3>

<h3 id="for-in-traverses-properties-recursively"><code>for...in</code> traverses properties recursively</h3>

<h3 id="for-of-is-like-for-range-in-go"><code>for...of</code> is like <code>for...range</code> in Go</h3>

<h3 id="object-constructor-prototype">object.constructor.prototype</h3>

<pre><code>    console.log({}.constructor === {}['__proto__'].constructor);
    console.log({}.constructor.prototype === {}['__proto__']);
</code></pre>

<h3 id="promise-can-be-chained-and-composed">Promise can be chained and composed</h3>

<p>It is quite impressive how JS do concurrency differently and efficiently.</p>

<p><code>Promise.then(onFulfilled)</code> where <code>onFufilled</code> can return another Promise.</p>

<pre><code>Promise.all([func1(), func2(), func3()])
.then(([result1, result2, result3]) =&gt; { /* use result1, result2 and result3 */ });
</code></pre>

<h3 id="computed-property-name">Computed property name</h3>

<pre><code>{
    [prop]: 42,
}
</code></pre>

<h3 id="there-are-two-types-of-generator-method-syntax">There are two types of generator method syntax</h3>

<pre><code>{
    *gen() {

    }
}
</code></pre>

<pre><code>{
    gen: function*() {

    }
}
</code></pre>

                </div>
            </article>
        
            <article class="frontpage">
                <h1>
                    <a href="http://h12.io/project/run/">Run: Graceful Goroutine Orchestration</a>
                    <span class="line"></span>
                </h1>
                <span class="time">14 December 2018</span>
                <div class="article-body hyphenate">
                    

<p><a href="https://godoc.org/h12.io/run"><img src="https://godoc.org/h12.io/run?status.svg" alt="GoDoc" /></a></p>

<h2 id="overview">Overview</h2>

<p>While Go provides goroutines, channels and selects as first-class citizens to
support concurrent programming, it is not trivial to combine these elements
to address important concerns of goroutine orchestration, e.g. error handling,
panic recovery, goroutine leak prevention, goroutine reuse, goroutine throttle
and logging.</p>

<p>The package provides a mini-framework to address those cross-cutting concerns.</p>

<h2 id="quick-start">Quick start</h2>

<pre><code class="language-bash">go get -u h12.io/run
</code></pre>

<p>Here is an example illustrating the usage of the goroutine pool and the group.
The task is described in the &ldquo;Google Search 2.0&rdquo; page from <a href="https://talks.golang.org/2012/concurrency.slide#46">this slide</a>.</p>

<pre><code class="language-go">// the goroutine pool
pool := run.NewGoroutinePool(
	run.Max(8),                // the pool contains maximum 8 goroutines
	run.IdleTime(time.Minute), // a goroutine will stay in idle for maximum 1 minute before exiting
)

// the group
// the goroutine pool might have longer lifespan than the group
group := run.NewGroup(
	context.Background(), // a context that can cancel the whole group
	run.Pool(pool),       // the goroutine pool used by the group
	run.Recover(true),    // recover from panic and returns the PanicError
	run.Log(func(info *run.LogInfo) { // a log function for all starts/stops
		log.Print(info)
	}),
)

searches := []*GoogleSearch{
	{Search: Web, Query: &quot;golang&quot;},
	{Search: Image, Query: &quot;golang&quot;},
	{Search: Video, Query: &quot;golang&quot;},
}
for _, search := range searches {
	// start searching in parallel
	if err := group.Go(search); err != nil {
		log.Fatal(err)
	}
}

// wait for all searches stop
if err := group.Wait(); err != nil {
	log.Fatal(err)
}

for _, search := range searches {
	fmt.Println(search.Result)
}
</code></pre>

<p>See the full example <a href="https://github.com/h12w/run/blob/master/example/search/main.go">here</a>.</p>

<h2 id="design">Design</h2>

<p>The package is built around the concept of a runner.</p>

<pre><code class="language-go">type Runner interface {
	Run(context.Context) error
}
</code></pre>

<p>A correct implementation of a runner should satisify the following conditions:</p>

<ul>
<li>blocks when the work is on going</li>
<li>returns when all work is done, an error occurred or context is cancelled</li>
</ul>

<p>With goroutine pool and group in the package, the user does not need to use
the go statement explicitly, but only needs to implement their objects
satisfying the Runner interface.</p>

<p>A Group is useful when multiple concurrent sub-tasks needed to be combined as
a single task (the task failed when one of them failed, every sub-task should be
cancelled when the task is cancelled).</p>

<p>A Pool is useful when there are many short-lived gorotuines.</p>

<p>Group can be built upon pool, not vice versa.</p>

                </div>
            </article>
        
            <article class="frontpage">
                <h1>
                    <a href="http://h12.io/note/start-godoc/">How to Start Godoc on Mac</a>
                    <span class="line"></span>
                </h1>
                <span class="time">5 May 2018</span>
                <div class="article-body hyphenate">
                    <p>Fish:</p>

<pre><code class="language-fish">godoc -http=:6060 &amp;; disown (pidof godoc)
</code></pre>

<p>Bash:</p>

<pre><code>godoc -http=:6060 &amp;; disown `pidof godoc`
</code></pre>

<p>And pidof can be installed with Homebrew.</p>

                </div>
            </article>
        
            <article class="frontpage">
                <h1>
                    <a href="http://h12.io/note/tmux-cheatsheet/">Tmux Cheatsheet on Mac</a>
                    <span class="line"></span>
                </h1>
                <span class="time">20 April 2018</span>
                <div class="article-body hyphenate">
                    

<h3 id="create-a-new-session-with-iterm2-integration">Create a new session with iTerm2 integration</h3>

<pre><code class="language-bash">tmux -CC new -s [session-name]
</code></pre>

<h3 id="attach-to-a-session-with-iterm2-integration">Attach to a session with iTerm2 integration</h3>

<pre><code class="language-bash">tmux -CC attach -t [session-name]
</code></pre>

                </div>
            </article>
        
        <nav class="pagination">
            <span>- 2 -</span>
            <ul>
                <li>
            
                    <a href="/">« Prev</a>
            
                </li>
                <li>
            
                    <a href="/page/3">Next »</a>
            
                </li>
            </ul>
        </nav>
        </main>
        <footer id="site-footer">
            <hr>
            <p>&copy; 2012-2023 <span class="my-name">Hǎi-Liàng "Hal" Wáng</span>.<br>
            The content of this page is licensed under <a rel="license" href="http://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution 4.0 International License</a>, and code is licensed under a <a rel="license" href="/bsd">BSD license</a>.
            </p>
        </footer>

    </body>
</html>
